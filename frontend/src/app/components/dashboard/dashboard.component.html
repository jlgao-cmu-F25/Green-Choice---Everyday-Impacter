<app-header/>
<div class="container">
  <header class="header">
    <h1>üåç Everyday Impact Calculator</h1>
    <p class="tagline">Every small action counts!</p>
  </header>

  @if (loading) {
    <div class="loading">Loading...</div>
  }

  @if (!loading) {
    <div>
      <!-- Streak Display -->
      @if (userStats) {
        <div class="streak-card">
          <div class="streak-info">
            <div class="streak-item">
              <span class="streak-emoji">üî•</span>
              <div>
                <div class="streak-number">{{ userStats.currentStreak }}</div>
                <div class="streak-label">Day Streak</div>
              </div>
            </div>
            <div class="streak-item">
              <span class="streak-emoji">üèÜ</span>
              <div>
                <div class="streak-number">{{ userStats.longestStreak }}</div>
                <div class="streak-label">Best Streak</div>
              </div>
            </div>
          </div>
        </div>
      }
      <!-- Impact Summary -->
      <div class="impact-grid">
        <div class="impact-card">
          <h3>Today's Impact</h3>
          <div class="impact-stats">
            <div class="stat">
              <span class="stat-icon">üí®</span>
              <span class="stat-value">{{ todayImpact.co2.toFixed(2) }} kg</span>
              <span class="stat-label">CO‚ÇÇ Saved</span>
            </div>
            <div class="stat">
              <span class="stat-icon">üíß</span>
              <span class="stat-value">{{ todayImpact.water.toFixed(1) }} L</span>
              <span class="stat-label">Water Saved</span>
            </div>
            <div class="stat">
              <span class="stat-icon">‚ôªÔ∏è</span>
              <span class="stat-value">{{ todayImpact.waste.toFixed(2) }} kg</span>
              <span class="stat-label">Waste Reduced</span>
            </div>
          </div>
        </div>
        <div class="impact-card">
          <h3>This Week</h3>
          <div class="impact-stats">
            <div class="stat">
              <span class="stat-icon">üí®</span>
              <span class="stat-value">{{ weekImpact.co2.toFixed(2) }} kg</span>
              <span class="stat-label">CO‚ÇÇ Saved</span>
            </div>
            <div class="stat">
              <span class="stat-icon">üíß</span>
              <span class="stat-value">{{ weekImpact.water.toFixed(1) }} L</span>
              <span class="stat-label">Water Saved</span>
            </div>
            <div class="stat">
              <span class="stat-icon">‚ôªÔ∏è</span>
              <span class="stat-value">{{ weekImpact.waste.toFixed(2) }} kg</span>
              <span class="stat-label">Waste Reduced</span>
            </div>
          </div>
        </div>
      </div>
      <!-- Insights -->
      @if (insights.length > 0) {
        <div class="insights-card">
          <h3>üí° Your Impact This Week</h3>
          <ul class="insights-list">
            @for (insight of insights; track insight) {
              <li>{{ insight }}</li>
            }
          </ul>
        </div>
      }
      
      <!-- Navigation to Leaderboard -->
      <div class="impact-card leaderboard-nav">
        <h3>üèÜ Leaderboard</h3>
        <p>See how you rank against other eco-warriors!</p>
        <button class="leaderboard-button" (click)="navigateToLeaderboard()">
          View Leaderboard ‚Üí
        </button>
      </div>
      
      <!-- Action Buttons -->
      <div class="actions-section">
        <h2>Log Your Eco-Actions</h2>
        <div class="action-grid">
          <!-- Special Bike Action Button -->
          <button
            class="action-button"
            (click)="showBikeAction()">
            <span class="action-icon">üö¥‚Äç‚ôÇÔ∏è</span>
            <span class="action-name">Bike Ride</span>
            <span class="action-impact">Calculate CO‚ÇÇ savings</span>
          </button>
          
          @for (action of ecoActions; track action) {
            <button
              class="action-button"
              (click)="logAction(action)">
              <span class="action-icon">{{ action.icon }}</span>
              <span class="action-name">{{ action.name }}</span>
              <span class="action-impact">-{{ action.co2Saved }} kg CO‚ÇÇ</span>
            </button>
          }
        </div>
      </div>
      <!-- Total Impact -->
      @if (userStats) {
        <div class="total-impact">
          <h3>All-Time Impact</h3>
          <div class="total-stats">
            <div class="total-stat">
              <div class="total-value">{{ userStats.totalCO2Saved.toFixed(2) }}</div>
              <div class="total-label">kg CO‚ÇÇ saved</div>
            </div>
            <div class="total-stat">
              <div class="total-value">{{ userStats.totalWaterSaved.toFixed(1) }}</div>
              <div class="total-label">Liters water saved</div>
            </div>
            <div class="total-stat">
              <div class="total-value">{{ userStats.totalWasteSaved.toFixed(2) }}</div>
              <div class="total-label">kg waste reduced</div>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>

<!-- Bike Action Modal -->
<app-bike-action 
  (bikeRideLogged)="onBikeRideLogged($event)">
</app-bike-action>
